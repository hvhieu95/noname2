{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport { useContext, useEffect } from \"react\";\nimport { DocViewerContext } from \"../store/DocViewerProvider\";\nimport { setDocumentLoading, updateCurrentDocument } from \"../store/actions\";\nimport { defaultFileLoader } from \"../utils/fileLoaders\";\nimport { useRendererSelector } from \"./useRendererSelector\";\n/**\r\n * Custom Hook for loading the current document into context\r\n */\nexport var useDocumentLoader = function useDocumentLoader() {\n  var _a = useContext(DocViewerContext),\n    state = _a.state,\n    dispatch = _a.dispatch;\n  var currentFileNo = state.currentFileNo,\n    currentDocument = state.currentDocument,\n    prefetchMethod = state.prefetchMethod;\n  var CurrentRenderer = useRendererSelector().CurrentRenderer;\n  var documentURI = (currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.uri) || \"\";\n  useEffect(function () {\n    if (!currentDocument) return;\n    if (currentDocument.fileType !== undefined) return;\n    var controller = new AbortController();\n    var signal = controller.signal;\n    fetch(documentURI, {\n      method: prefetchMethod || documentURI.startsWith(\"blob:\") ? \"GET\" : \"HEAD\",\n      signal: signal,\n      headers: state === null || state === void 0 ? void 0 : state.requestHeaders\n    }).then(function (response) {\n      var contentTypeRaw = response.headers.get(\"content-type\");\n      var contentTypes = (contentTypeRaw === null || contentTypeRaw === void 0 ? void 0 : contentTypeRaw.split(\";\")) || [];\n      var contentType = contentTypes.length ? contentTypes[0] : undefined;\n      dispatch(updateCurrentDocument(__assign(__assign({}, currentDocument), {\n        fileType: contentType || undefined\n      })));\n    }).catch(function (error) {\n      if ((error === null || error === void 0 ? void 0 : error.name) !== \"AbortError\") {\n        throw error;\n      }\n    });\n    return function () {\n      controller.abort();\n    };\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [currentFileNo, documentURI, currentDocument]);\n  useEffect(function () {\n    var _a;\n    if (!currentDocument || CurrentRenderer === undefined) return;\n    var controller = new AbortController();\n    var signal = controller.signal;\n    var fileLoaderComplete = function fileLoaderComplete(fileReader) {\n      if (!currentDocument || !fileReader) {\n        dispatch(setDocumentLoading(false));\n        return;\n      }\n      var updatedDocument = __assign({}, currentDocument);\n      if (fileReader.result !== null) {\n        updatedDocument.fileData = fileReader.result;\n      }\n      dispatch(updateCurrentDocument(updatedDocument));\n      dispatch(setDocumentLoading(false));\n    };\n    var loaderFunctionProps = {\n      documentURI: documentURI,\n      signal: signal,\n      fileLoaderComplete: fileLoaderComplete,\n      headers: state === null || state === void 0 ? void 0 : state.requestHeaders\n    };\n    if (CurrentRenderer === null) {\n      dispatch(setDocumentLoading(false));\n    } else if (CurrentRenderer.fileLoader !== undefined) {\n      (_a = CurrentRenderer.fileLoader) === null || _a === void 0 ? void 0 : _a.call(CurrentRenderer, loaderFunctionProps);\n    } else {\n      defaultFileLoader(loaderFunctionProps);\n    }\n    return function () {\n      controller.abort();\n    };\n    /* eslint-disable react-hooks/exhaustive-deps */\n  }, [CurrentRenderer, currentFileNo]);\n  return {\n    state: state,\n    dispatch: dispatch,\n    CurrentRenderer: CurrentRenderer\n  };\n};","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","useContext","useEffect","DocViewerContext","setDocumentLoading","updateCurrentDocument","defaultFileLoader","useRendererSelector","useDocumentLoader","_a","state","dispatch","currentFileNo","currentDocument","prefetchMethod","CurrentRenderer","documentURI","uri","fileType","undefined","controller","AbortController","signal","fetch","method","startsWith","headers","requestHeaders","then","response","contentTypeRaw","get","contentTypes","split","contentType","catch","error","name","abort","fileLoaderComplete","fileReader","updatedDocument","result","fileData","loaderFunctionProps","fileLoader"],"sources":["C:/Users/hoang/OneDrive/Máy tính/noname/node_modules/@cyntler/react-doc-viewer/dist/esm/hooks/useDocumentLoader.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { useContext, useEffect } from \"react\";\r\nimport { DocViewerContext } from \"../store/DocViewerProvider\";\r\nimport { setDocumentLoading, updateCurrentDocument, } from \"../store/actions\";\r\nimport { defaultFileLoader, } from \"../utils/fileLoaders\";\r\nimport { useRendererSelector } from \"./useRendererSelector\";\r\n/**\r\n * Custom Hook for loading the current document into context\r\n */\r\nexport var useDocumentLoader = function () {\r\n    var _a = useContext(DocViewerContext), state = _a.state, dispatch = _a.dispatch;\r\n    var currentFileNo = state.currentFileNo, currentDocument = state.currentDocument, prefetchMethod = state.prefetchMethod;\r\n    var CurrentRenderer = useRendererSelector().CurrentRenderer;\r\n    var documentURI = (currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.uri) || \"\";\r\n    useEffect(function () {\r\n        if (!currentDocument)\r\n            return;\r\n        if (currentDocument.fileType !== undefined)\r\n            return;\r\n        var controller = new AbortController();\r\n        var signal = controller.signal;\r\n        fetch(documentURI, {\r\n            method: prefetchMethod || documentURI.startsWith(\"blob:\") ? \"GET\" : \"HEAD\",\r\n            signal: signal,\r\n            headers: state === null || state === void 0 ? void 0 : state.requestHeaders,\r\n        })\r\n            .then(function (response) {\r\n            var contentTypeRaw = response.headers.get(\"content-type\");\r\n            var contentTypes = (contentTypeRaw === null || contentTypeRaw === void 0 ? void 0 : contentTypeRaw.split(\";\")) || [];\r\n            var contentType = contentTypes.length ? contentTypes[0] : undefined;\r\n            dispatch(updateCurrentDocument(__assign(__assign({}, currentDocument), { fileType: contentType || undefined })));\r\n        })\r\n            .catch(function (error) {\r\n            if ((error === null || error === void 0 ? void 0 : error.name) !== \"AbortError\") {\r\n                throw error;\r\n            }\r\n        });\r\n        return function () {\r\n            controller.abort();\r\n        };\r\n    }, \r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [currentFileNo, documentURI, currentDocument]);\r\n    useEffect(function () {\r\n        var _a;\r\n        if (!currentDocument || CurrentRenderer === undefined)\r\n            return;\r\n        var controller = new AbortController();\r\n        var signal = controller.signal;\r\n        var fileLoaderComplete = function (fileReader) {\r\n            if (!currentDocument || !fileReader) {\r\n                dispatch(setDocumentLoading(false));\r\n                return;\r\n            }\r\n            var updatedDocument = __assign({}, currentDocument);\r\n            if (fileReader.result !== null) {\r\n                updatedDocument.fileData = fileReader.result;\r\n            }\r\n            dispatch(updateCurrentDocument(updatedDocument));\r\n            dispatch(setDocumentLoading(false));\r\n        };\r\n        var loaderFunctionProps = {\r\n            documentURI: documentURI,\r\n            signal: signal,\r\n            fileLoaderComplete: fileLoaderComplete,\r\n            headers: state === null || state === void 0 ? void 0 : state.requestHeaders,\r\n        };\r\n        if (CurrentRenderer === null) {\r\n            dispatch(setDocumentLoading(false));\r\n        }\r\n        else if (CurrentRenderer.fileLoader !== undefined) {\r\n            (_a = CurrentRenderer.fileLoader) === null || _a === void 0 ? void 0 : _a.call(CurrentRenderer, loaderFunctionProps);\r\n        }\r\n        else {\r\n            defaultFileLoader(loaderFunctionProps);\r\n        }\r\n        return function () {\r\n            controller.abort();\r\n        };\r\n        /* eslint-disable react-hooks/exhaustive-deps */\r\n    }, [CurrentRenderer, currentFileNo]);\r\n    return { state: state, dispatch: dispatch, CurrentRenderer: CurrentRenderer };\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}